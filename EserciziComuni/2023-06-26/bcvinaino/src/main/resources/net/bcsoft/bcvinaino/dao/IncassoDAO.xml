<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.bcsoft.bcvinaino.dao.IncassoDAO">

    <select id="calcolaIncassi" resultMap="incassiReportMap">
        SELECT ordini.data_ordine, SUM(menu.prezzo * articoli_ordine.qta)
        FROM ordini JOIN articoli_ordine ON ordini.id_ordine = articoli_ordine.id_ordine
        JOIN menu on articoli_ordine.id_menu = menu.id_menu
        GROUP BY ordini.data_ordine
        ORDER BY ordini.data_ordine DESC
    </select>

    <resultMap id="incassiReportMap" type="net.bcsoft.bcvinaino.entity.IncassoGiornaliero">
        <result property="data" column="data_ordine"/>
        <result property="incasso" column="sum"/>
    </resultMap>

</mapper>